generator client {
  provider      = "prisma-client-js"
  output        = "./generated-client"
  binaryTargets = ["native", "debian-openssl-3.0.x", "linux-musl-openssl-3.0.x"]
}

datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

model User {
  id         Int      @id @default(autoincrement())
  telegramId String   @unique
  name       String
  role       String   @default("child") // "parent" | "child"
  points     Int      @default(0)
  createdAt  DateTime @default(now())
  tasks      Task[]   @relation("AssignedTasks")
  purchases  Purchase[]
}

model Task {
  id          Int      @id @default(autoincrement())
  title       String
  description String
  reward      Int
  status      String   @default("active") // "active" | "pending" | "completed"
  assignee    User?    @relation("AssignedTasks", fields: [assigneeId], references: [id])
  assigneeId  Int?
  isGlobal    Boolean  @default(false)
  createdAt   DateTime @default(now())
}

model StoreItem {
  id          Int      @id @default(autoincrement())
  title       String
  description String
  price       Int
  icon        String?
  createdAt   DateTime @default(now())
  purchases   Purchase[]
}

model Purchase {
  id        Int      @id @default(autoincrement())
  user      User     @relation(fields: [userId], references: [id])
  userId    Int
  item      StoreItem @relation(fields: [itemId], references: [id])
  itemId    Int
  status    String   @default("bought") // "bought" | "received"
  createdAt DateTime @default(now())
}
